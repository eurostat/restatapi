<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a filter table — create_filter_table • restatapi</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a filter table — create_filter_table" />
<meta property="og:description" content="Create filter table from the filters and date_filter strings parameters of the get_eurostat_data to be used in the filter_raw_data function for filtering by query or on the local computer." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">restatapi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/eurostat/restatapi/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a filter table</h1>
    <small class="dont-index">Source: <a href='https://github.com/eurostat/restatapi/blob/master/R/create_filter_table.R'><code>R/create_filter_table.R</code></a></small>
    <div class="hidden name"><code>create_filter_table.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create filter table from the <code>filters</code> and <code>date_filter</code> strings parameters of the <code><a href='get_eurostat_data.html'>get_eurostat_data</a></code> to be used in the <code><a href='filter_raw_data.html'>filter_raw_data</a></code> function for filtering by query or on the local computer.</p>
    </div>

    <pre class="usage"><span class='fu'>create_filter_table</span><span class='op'>(</span>
  <span class='va'>filters</span>,
  date_filter <span class='op'>=</span> <span class='cn'>FALSE</span>,
  dsd <span class='op'>=</span> <span class='cn'>NULL</span>,
  exact_match <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>filters</th>
      <td><p>a string, a character or numeric vector or a named list containing words to filter by the different concepts, geographical location or time values.
The words can be any word, Eurostat variable code, or value which are in the Data Structure Definition (DSD) and can be retrieved by the <code><a href='search_eurostat_dsd.html'>search_eurostat_dsd</a></code> function. 
If a named list is used, then the name of the list elements should be the concepts from the DSD and the provided values will be used to filter the dataset for the given concept.
The default is <code>NULL</code>, in this case no filter table is created. To filter by time see <code>date_filter</code> below.
In case for filtering for time values, the date shall be defined as character string, and it should follow the format yyyy[-mm][-dd], where the month and the day part is optional.</p></td>
    </tr>
    <tr>
      <th>date_filter</th>
      <td><p>a logical value. If <code>TRUE</code> the filter table is genrated only for the time dimension. The default is <code>FALSE</code>, 
in this case a (<code>dsd</code>) should be provided which will be searched for the values given in the <code>filters</code>.</p></td>
    </tr>
    <tr>
      <th>dsd</th>
      <td><p>a table containing a DSD of an Eurostat dataset which can be retreived by the <code><a href='get_eurostat_dsd.html'>get_eurostat_dsd</a></code> function.</p></td>
    </tr>
    <tr>
      <th>exact_match</th>
      <td><p>a logical value with the default value <code>TRUE</code>, if the strings provided in <code>filters</code> shall be matched exactly as it is or as a pattern in the DSD.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>a logical value with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code><a href='https://rdrr.io/r/base/options.html'>options(restatapi_verbose=TRUE)</a></code></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments to the for <code><a href='search_eurostat_dsd.html'>search_eurostat_dsd</a></code> function, e.g.: <code>ignore.case</code> or <code>name</code>. 
The <code>ignore.case</code> has the default value <code>FALSE</code>, then the strings provided in <code>filters</code> are matched as is, 
otherwise the case of the letters is ignored. If the <code>name=FALSE</code> then the pattern(s) provided in the <code>filters</code>
argument is only searched in the code column of the DSD, and the names of the codes will not be searched.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data.table containing in each row a distinct filtering condition to be applied to a raw Eurostat datatable or generate specific query.</p>
<p>If <code>date_filter=TRUE</code>, the output data table contains two columns with the following names:</p><table class='table'>
<tr><td><code>sd</code></td><td>Starting date to be included in the filtered dataset, where date is formatted yyyy[-mm][-dd]</td></tr>
<tr><td><code>ed</code></td><td>End date of the period to be included in the filtered dataset, where the date is formatted yyyy[-mm][-dd]</td></tr>
</table>
<p>In case <code>date_filter=FALSE</code>, the output tables have the following four columns:</p><table class='table'>
<tr><td><code>pattern</code></td><td>Containing those parts of the <code>filters</code> string where the string part (pattern) was found in the <code>dsd</code></td></tr>
<tr><td><code>concept</code></td><td>The name of the concepts corresponding to the result in the code/name column where the pattern was found in the data structure definition</td></tr>
<tr><td><code>code</code></td><td>The list of codes where the pattern was found, or the code of a name (description of the code) where the pattern appears</td></tr>
<tr><td><code>name</code></td><td>The name (description of the code) which can be used as label for the code where the pattern was found, or the name (description of the code) of the code where the pattern appears</td></tr>
</table>


    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>It is a sub-function to use in the <code><a href='get_eurostat_data.html'>get_eurostat_data</a></code> to generate url for the given <code>filters</code> and <code>date_filter</code> in that function. The output can be used also for filtering data 
         on the local computer with the <code><a href='get_eurostat_raw.html'>get_eurostat_raw</a></code> and <code><a href='filter_raw_data.html'>filter_raw_data</a></code> function, if the direct response from REST API did not provide data because of too large data set.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='get_eurostat_raw.html'>get_eurostat_raw</a></code>, <code><a href='search_eurostat_dsd.html'>search_eurostat_dsd</a></code>, <code><a href='get_eurostat_data.html'>get_eurostat_data</a></code>, <code><a href='filter_raw_data.html'>filter_raw_data</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \dontshow{</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>&lt;=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>{</span>
   <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>restatapi_cores<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='op'>}</span><span class='kw'>else</span><span class='op'>{</span>
   <span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>restatapi_cores<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
<span class='op'>}</span>    
<span class='va'>cfg</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"cfg"</span>,envir<span class='op'>=</span><span class='fu'>restatapi</span><span class='fu'>::</span><span class='va'><a href='.restatapi_env.html'>.restatapi_env</a></span><span class='op'>)</span> 
<span class='va'>rav</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/get.html'>get</a></span><span class='op'>(</span><span class='st'>"rav"</span>,envir<span class='op'>=</span><span class='fu'>restatapi</span><span class='fu'>::</span><span class='va'><a href='.restatapi_env.html'>.restatapi_env</a></span><span class='op'>)</span>
<span class='co'># }</span>
<span class='va'>dsd</span><span class='op'>&lt;-</span><span class='fu'><a href='get_eurostat_dsd.html'>get_eurostat_dsd</a></span><span class='op'>(</span><span class='st'>"avia_par_me"</span><span class='op'>)</span> 
<span class='fu'>create_filter_table</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"KYIV"</span>,<span class='st'>"hu"</span>,<span class='st'>"Quarterly"</span><span class='op'>)</span>,dsd<span class='op'>=</span><span class='va'>dsd</span>,exact_match<span class='op'>=</span><span class='cn'>FALSE</span>,ignore.case<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      pattern concept            code
#&gt; 1:      KYIV AIRP_PR ME_LYTV_UA_UKBB
#&gt; 2:      KYIV AIRP_PR ME_LYTV_UA_UKKK
#&gt; 3:        hu AIRP_PR ME_LYPG_HU_LHBP
#&gt; 4:        hu AIRP_PR ME_LYTV_UA_UKKK
#&gt; 5: Quarterly    FREQ               Q
#&gt;                                                               name
#&gt; 1:                           TIVAT airport - KYIV/BORYSPIL airport
#&gt; 2:                           TIVAT airport - KYIV/ZHULIANY airport
#&gt; 3: PODGORICA airport - BUDAPEST/LISZT FERENC INTERNATIONAL airport
#&gt; 4:                           TIVAT airport - KYIV/ZHULIANY airport
#&gt; 5:                                                       Quarterly</div><div class='input'><span class='fu'>create_filter_table</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"KYIV"</span>,<span class='st'>"LHBP"</span>,<span class='st'>"Monthly"</span><span class='op'>)</span>,dsd<span class='op'>=</span><span class='va'>dsd</span>,exact_match<span class='op'>=</span><span class='cn'>FALSE</span>,name<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    pattern concept            code
#&gt; 1:    LHBP AIRP_PR ME_LYPG_HU_LHBP
#&gt;                                                               name
#&gt; 1: PODGORICA airport - BUDAPEST/LISZT FERENC INTERNATIONAL airport</div><div class='input'><span class='fu'>create_filter_table</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2017-03"</span>,
                      <span class='st'>"2001-03:2005"</span>,
                      <span class='st'>"&lt;2000-07-01"</span>,
                      <span class='fl'>2012</span><span class='op'>:</span><span class='fl'>2014</span>,
                      <span class='st'>"2018&lt;"</span>,
                      <span class='fl'>20912</span>,
                      <span class='st'>"&lt;3452&lt;"</span>,
                      <span class='st'>":2018-04&gt;"</span>,
                      <span class='st'>"2&lt;034v"</span>,
                      <span class='st'>"2008:2013"</span><span class='op'>)</span>,
                    date_filter<span class='op'>=</span><span class='cn'>TRUE</span>,
                    verbose<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>filters: 2017-032001-03:2005&lt;2000-07-012012201320142018&lt;20912&lt;3452&lt;:2018-04&gt;2&lt;034v2008:2013; is numeric: FALSE; call parents: 35</span></div><div class='output co'>#&gt; <span class='message'>length df: 12 -*- df: 2017-03, 2001-03:2005, &lt;2000-07-01, 2012, 2013, 2014, 2018&lt;, 20912, &lt;3452&lt;, :2018-04&gt;, 2&lt;034v, 2008:2013</span></div><div class='output co'>#&gt; <span class='message'>The date filter had invalid character (not 0-9, '-', '&lt;', '&gt;' or ':'). Those characters removed from the date filter.</span></div><div class='output co'>#&gt; <span class='message'>create_filter_table -  2017-03, create_filter_table -  2001-03:2005, create_filter_table -  &lt;2000-07-01, create_filter_table -  2012, create_filter_table -  2013, create_filter_table -  2014, create_filter_table -  2018&lt;, create_filter_table -  20912, create_filter_table -  &lt;3452&lt;, create_filter_table -  :2018-04&gt;, create_filter_table -  2&lt;034, create_filter_table -  2008:2013 date filter length: 12, nchar date_filter: 7,12,11,4,4,4,5,5,6,9,5,9</span></div><div class='output co'>#&gt; <span class='message'>Could not parse date filter: '20912' not in [&lt;&gt;]yyyy[-mm][-dd][&lt;&gt;] format or incorrect date value. The date filter is ignored.</span></div><div class='output co'>#&gt; <span class='message'>Could not parse date filter: '&lt;3452&lt;'. This date filter is ignored.</span></div><div class='output co'>#&gt; <span class='message'>Could not parse date filter: ':2018-04&gt;'. This date filter is ignored.</span></div><div class='output co'>#&gt; <span class='message'>Could not parse date filter: '2&lt;034' not in [&lt;&gt;]yyyy[-mm][-dd][&lt;&gt;] format or incorrect date value. The date filter is ignored.</span></div><div class='output co'>#&gt;            sd         ed
#&gt; 1:          0 2000-07-01
#&gt; 2: 2001-03-01 2005-12-31
#&gt; 3: 2008-01-01 2014-12-31
#&gt; 4: 2017-03-01 2017-03-31
#&gt; 5: 2018-01-01        Inf</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mátyás Mészáros.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


